# 運用上の課題と懸念事項 (Issues)

`src/code.gs` への翻訳機能統合に伴い、運用上注意すべき点や将来的な課題を記録します。

## 1. スクリプトプロパティの設定
統合後のコードでは以下のスクリプトプロパティが必要です。設定漏れがないか確認してください。
- `CHANNEL_ACCESS_TOKEN`: LINE Botのチャネルアクセストークン（旧 `translator.gs` では `LINE_CHANNEL_ACCESS_TOKEN` として参照されていた可能性がありますが、`code.gs` の命名に統一しました）
- `GEMINI_API_KEY`: Google Gemini APIのキー
- `SPREADSHEET_ID`: データベースとして使用するスプレッドシートのID
- `WEB_APP_URL`: デプロイされたWebアプリのURL（アンケート機能で使用）

## 2. スプレッドシートの容量
新しい「翻訳ログ」シート（`TRANSLATION_LOG`）は、翻訳が行われるたびにレコードが追加されます。
活発なチャットが行われるグループでは行数が急速に増加し、スプレッドシートの最大セル数（500万セル）制限に近づく可能性があります。
定期的に古いログを削除するか、アーカイブする運用を検討してください。

## 3. Gemini APIのレート制限
Gemini APIにはレート制限があります（特に無料枠の場合）。
`RATE_LIMIT_EXCEEDED` エラーが発生した場合、ユーザーには「AIサービスのレートリミットに到達しました」というメッセージが返されますが、頻発する場合は有料プランへの移行や、翻訳頻度の調整（特定のキーワードのみ翻訳するなど）が必要です。

## 4. Botの応答頻度
現在の実装では、アンケート投稿や名前変更コマンド以外の**すべてのテキストメッセージ**に対して翻訳を行い、返信します。
雑談や挨拶など、翻訳不要なメッセージに対しても翻訳結果（日本語→英語・ポーランド語、または他言語→日本語）を返信するため、チャットが騒がしくなる可能性があります。
必要に応じて、特定のプレフィックス（例: `!trans`）がある場合のみ翻訳するなどの仕様変更を検討してください。

## 5. システム診断機能の廃止
`translator.gs` に実装されていた `doGet` によるシステム診断機能（APIキー設定状況の確認など）は、アンケート回答画面（Webアプリ）との競合を避けるため削除されました。
設定の確認はApps Scriptのエディタ上で行うか、別途デバッグ用の関数を実行して確認する必要があります。

## 6. エラーハンドリング
翻訳エラー時やAPIエラー時にユーザーへエラーメッセージを返信しています。
一時的な障害でエラーが連続する場合、エラーメッセージがチャットを埋め尽くす可能性があります。
エラー通知を管理者のみ（デバッグシート）にするか、ユーザーへの通知頻度を制御する改善が考えられます。
